---
import Layout from '../layouts/Layout.astro';
import PageHeader from '../componentes/ui/PageHeader.astro';
import Boton from '../componentes/ui/boton.astro';
---

<Layout
  title="Formulario PQRS - Peticiones, Quejas, Reclamos y Sugerencias"
  description="üìù Env√≠a tu Petici√≥n, Queja, Reclamo, Sugerencia o Felicitaci√≥n. Te contactaremos en menos de 24 horas. Sistema de atenci√≥n al cliente de Transporte y Turismo Antioquia."
>
  <!-- Header de la p√°gina -->
  <PageHeader
    titulo="Formulario PQRS"
    imagenFondo="https://images.unsplash.com/photo-1449965408869-eaa3f722e40d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80"
  />

  <!-- Contenido principal -->
  <main class="bg-light py-16">
    <div class="container mx-auto px-4">
      <div class="grid gap-12 lg:grid-cols-2">
        <!-- Columna izquierda: Formulario PQRS -->
        <div>
          <!-- T√≠tulo -->
          <div class="mb-8">
            <h2 class="text-dark mb-4 font-[Poppins] text-3xl font-bold">
              Formulario PQRS
            </h2>
            <p class="font-[Inter] text-lg text-gray-600">
              Completa el formulario para enviar tu Petici√≥n, Queja, Reclamo o Sugerencia. Nos pondremos en contacto contigo en menos de 24 horas.
            </p>
          </div>

          <!-- Formulario -->
          <form
            id="quote-form"
            class="space-y-6 rounded-2xl bg-white p-8 shadow-lg"
          >
            <!-- Tipo de PQRS -->
            <div>
              <label for="service-type" class="text-dark mb-2 block font-[Poppins] font-semibold">
                Tipo de PQRS <span class="text-red-500">*</span>
              </label>
              <select
                id="service-type"
                name="serviceType"
                required
                class="focus:border-primary focus:ring-primary w-full rounded-lg border border-gray-300 px-4 py-3 font-[Inter] transition-colors duration-200 focus:outline-none focus:ring-2"
              >
                <option value="">Selecciona el tipo</option>
                <option value="peticion">Petici√≥n</option>
                <option value="queja">Queja</option>
                <option value="reclamo">Reclamo</option>
                <option value="sugerencia">Sugerencia</option>
                <option value="felicitacion">Felicitaci√≥n</option>
              </select>
            </div>

            <!-- Nombre -->
            <div>
              <label for="name" class="text-dark mb-2 block font-[Poppins] font-semibold">
                Nombre Completo <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="name"
                name="name"
                required
                class="focus:border-primary focus:ring-primary w-full rounded-lg border border-gray-300 px-4 py-3 font-[Inter] transition-colors duration-200 focus:outline-none focus:ring-2"
                placeholder="Juan P√©rez"
              />
            </div>

            <!-- Grid de 2 columnas -->
            <div class="grid gap-4 sm:grid-cols-2">
              <!-- Email -->
              <div>
                <label for="email" class="text-dark mb-2 block font-[Poppins] font-semibold">
                  Email <span class="text-red-500">*</span>
                </label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  class="focus:border-primary focus:ring-primary w-full rounded-lg border border-gray-300 px-4 py-3 font-[Inter] transition-colors duration-200 focus:outline-none focus:ring-2"
                  placeholder="tu@email.com"
                />
              </div>

              <!-- Tel√©fono -->
              <div>
                <label for="phone" class="text-dark mb-2 block font-[Poppins] font-semibold">
                  Tel√©fono <span class="text-red-500">*</span>
                </label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  required
                  class="focus:border-primary focus:ring-primary w-full rounded-lg border border-gray-300 px-4 py-3 font-[Inter] transition-colors duration-200 focus:outline-none focus:ring-2"
                  placeholder="+57 304 336 8556"
                />
              </div>
            </div>

            <!-- Mensaje Adicional -->
            <div>
              <label for="message" class="text-dark mb-2 block font-[Poppins] font-semibold">
                Informaci√≥n Adicional
              </label>
              <textarea
                id="message"
                name="message"
                rows="4"
                class="focus:border-primary focus:ring-primary w-full rounded-lg border border-gray-300 px-4 py-3 font-[Inter] transition-colors duration-200 focus:outline-none focus:ring-2"
                placeholder="Cu√©ntanos m√°s detalles sobre tu solicitud..."
              ></textarea>
            </div>

            <!-- Bot√≥n de env√≠o -->
            <Boton
              texto="Enviar PQRS"
              variante="primario"
              type="submit"
              clasePersonalizada="w-full py-4"
            />

            <!-- Mensaje de √©xito/error -->
            <div
              id="form-message"
              class="mt-4 hidden rounded-lg p-4 text-center font-[Inter]"
            ></div>
          </form>
        </div>

        <!-- Columna derecha: Informaci√≥n adicional -->
        <div class="space-y-8">
          <!-- Beneficios de usar nuestro sistema PQRS -->
          <div class="rounded-2xl bg-white p-8 shadow-lg">
            <h3 class="text-dark mb-6 font-[Poppins] text-2xl font-bold">
              ¬øPor qu√© usar nuestro sistema PQRS?
            </h3>
            <ul class="space-y-4">
              <li class="flex items-start gap-3">
                <svg
                  class="text-primary mt-1 h-6 w-6 shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 13l4 4L19 7"></path>
                </svg>
                <div>
                  <h4 class="text-dark font-[Poppins] font-semibold">Atenci√≥n Personalizada</h4>
                  <p class="font-[Inter] text-sm text-gray-600">
                    Tu solicitud ser√° atendida por nuestro equipo especializado
                  </p>
                </div>
              </li>
              <li class="flex items-start gap-3">
                <svg
                  class="text-primary mt-1 h-6 w-6 shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 13l4 4L19 7"></path>
                </svg>
                <div>
                  <h4 class="text-dark font-[Poppins] font-semibold">Respuesta R√°pida</h4>
                  <p class="font-[Inter] text-sm text-gray-600">
                    Te respondemos en menos de 24 horas
                  </p>
                </div>
              </li>
              <li class="flex items-start gap-3">
                <svg
                  class="text-primary mt-1 h-6 w-6 shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 13l4 4L19 7"></path>
                </svg>
                <div>
                  <h4 class="text-dark font-[Poppins] font-semibold">Seguimiento Garantizado</h4>
                  <p class="font-[Inter] text-sm text-gray-600">
                    Mantente informado del estado de tu solicitud
                  </p>
                </div>
              </li>
              <li class="flex items-start gap-3">
                <svg
                  class="text-primary mt-1 h-6 w-6 shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 13l4 4L19 7"></path>
                </svg>
                <div>
                  <h4 class="text-dark font-[Poppins] font-semibold">Proceso Confidencial</h4>
                  <p class="font-[Inter] text-sm text-gray-600">
                    Tu informaci√≥n ser√° tratada con total confidencialidad
                  </p>
                </div>
              </li>
            </ul>
          </div>

          <!-- Contacto directo -->
          <div class="bg-primary rounded-2xl p-8 text-white shadow-lg">
            <h3 class="mb-4 font-[Poppins] text-2xl font-bold">¬øPrefieres hablar directamente?</h3>
            <p class="mb-6 font-[Inter] text-gray-100">
              Nuestro equipo est√° disponible para atenderte por WhatsApp o tel√©fono.
            </p>
            <div class="space-y-4">
              <Boton
                texto="Chatear por WhatsApp"
                variante="primario"
                href="https://wa.me/573043368556?text=Hola,%20me%20gustar√≠a%20enviar%20una%20PQRS."
                target="_blank"
                clasePersonalizada="w-full bg-white text-primary hover:bg-gray-100"
              />
              <Boton
                texto="üìû +57 304 336 8556"
                variante="secundario"
                href="tel:+573043368556"
                clasePersonalizada="w-full"
              />
            </div>
          </div>

          <!-- Horario de atenci√≥n -->
          <div class="rounded-2xl bg-white p-8 shadow-lg">
            <h3 class="text-dark mb-4 font-[Poppins] text-2xl font-bold">Horario de Atenci√≥n</h3>
            <div class="space-y-3 font-[Inter]">
              <div class="flex justify-between">
                <span class="font-semibold text-gray-700">Lunes a Viernes:</span>
                <span class="text-gray-600">8:00 am ‚Äì 1:00 pm y 2:00 pm - 5:00 pm</span>
              </div>
              <div class="flex justify-between">
                <span class="font-semibold text-gray-700">S√°bado:</span>
                <span class="text-gray-600">8:30 am a 12:30 pm</span>
              </div>
              <div class="flex justify-between">
                <span class="font-semibold text-gray-700">Domingos y Festivos:</span>
                <span class="text-gray-600">No hay servicio (administrativo)</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</Layout>

<script>
  // Manejo del formulario de cotizaci√≥n
  const form = document.getElementById('quote-form') as HTMLFormElement;
  const formMessage = document.getElementById('form-message') as HTMLDivElement;

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
    const data = Object.fromEntries(formData);

    try {
      const response = await fetch('/api/contact', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          ...data,
          subject: `Formulario PQRS - ${data.serviceType}`,
        }),
      });

      if (response.ok) {
        formMessage.textContent =
          '‚úÖ ¬°PQRS enviado con √©xito! Te contactaremos pronto para dar respuesta.';
        formMessage.className =
          'mt-4 rounded-lg p-4 text-center font-[Inter] bg-green-100 text-green-700 border border-green-300';
        formMessage.classList.remove('hidden');
        form.reset();
      } else {
        throw new Error('Error en el env√≠o');
      }
    } catch {
      formMessage.textContent =
        '‚ùå Hubo un error al enviar el PQRS. Por favor, intenta nuevamente o cont√°ctanos por WhatsApp.';
      formMessage.className =
        'mt-4 rounded-lg p-4 text-center font-[Inter] bg-red-100 text-red-700 border border-red-300';
      formMessage.classList.remove('hidden');
    }
  });
</script>
